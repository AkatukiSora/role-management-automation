# ユーザーガイド

Role Management Automationの使用方法を順を追って説明します。

## 📋 目次

1. [アカウント作成](#1-アカウント作成)
2. [ネームスペース作成](#2-ネームスペース作成)
3. [外部サービスアカウント追加](#3-外部サービスアカウント追加)
4. [外部サービスグループ追加](#4-外部サービスグループ追加)
5. [タグ追加](#5-タグ追加)
6. [タグとロールの割当設定](#6-タグとロールの割当設定)
7. [メンバー追加](#7-メンバー追加)
8. [差分の反映](#8-差分の反映)

---

## 1. アカウント作成

### 概要
Role Management Automationを使用するために、まずアカウントを作成します。

### 手順
1. アプリケーションのホームページにアクセス
2. 「ログイン」ボタンをクリック
3. Discordアカウントで認証を行う
4. 初回ログイン時にユーザープロファイルが自動作成される

### 注意点
- Discordアカウントが必要です
- 初回ログイン後、自動的にダッシュボードにリダイレクトされます

---

## 2. ネームスペース作成

### 概要
ネームスペースは、プロジェクトやチームごとにロール管理を分離するための仕組みです。

### 手順
1. ダッシュボードから「Add team」をクリック
2. ネームスペース名を入力
3. 「作成」ボタンをクリック

### ネームスペースの役割
- 複数のプロジェクトを独立して管理
- チームメンバーのアクセス権限を制御
- サービスアカウントとグループの分離

---

## 3. 外部サービスアカウント追加

### 概要
各プラットフォーム（Discord、VRChat、GitHub）にアクセスするためのサービスアカウントを設定します。

### サポートするサービス

#### Discord Bot
1. ネームスペース設定から「認証情報を追加」を選択
2. 「Discord」を選択
3. Bot トークンを入力
4. 「認証情報を追加」をクリック

#### VRChat Account
1. 「VRChat」を選択
2. ユーザー名とパスワードを入力
3. 2FA有効の場合、TOTPキーを入力
4. 「認証情報を追加」をクリック

#### GitHub Application
1. 「GitHub」を選択
2. Client IDとPrivate Keyを入力
3. 「認証情報を追加」をクリック

### 注意点
- 各サービスで適切な権限設定が必要です
- 認証情報は暗号化して保存されます

---

## 4. 外部サービスグループ追加

### 概要
管理対象となるグループ（Discord Guild、VRChat Group、GitHub Organization）を追加します。

### サポートするグループ

#### Discord Guild（サーバー）
1. 「追加」から「Discord Guild」を選択
2. Guild ID（サーバーID）を入力
3. 使用するBotアカウントを選択
4. 「追加」をクリック

#### VRChat Group
1. 「VRChat Group」を選択
2. Group IDを入力
3. 使用するVRChatアカウントを選択
4. 「追加」をクリック

#### GitHub Organization
1. 「GitHub Organization」を選択
2. Organization名を入力
3. 使用するGitHub Applicationを選択
4. 「追加」をクリック

### 確認事項
- サービスアカウントが対象グループにアクセス可能であることを確認
- 必要な管理者権限が付与されていることを確認

---

## 5. タグ追加

### 概要
メンバーを分類・管理するためのタグを作成します。タグはロール割り当ての条件として使用されます。

### 手順
1. ネームスペース内で「タグ管理」に移動
2. 「タグを追加」をクリック
3. タグ名を入力
4. カラーを選択（視覚的な識別用）
5. 「追加」をクリック

### タグの例
- 「開発者」 - エンジニアメンバー
- 「管理者」 - プロジェクト管理者
- 「デザイナー」 - UIデザイナー
- 「新人」 - 新規参加メンバー

### 使用例
複数のタグを組み合わせてメンバーを詳細に分類できます。

---

## 6. タグとロールの割当設定

### 概要
作成したタグの組み合わせに基づいて、各プラットフォームのロールを自動で割り当てるルールを設定します。

### 手順
1. 「ロール管理」の「割り当て」に移動
2. 「割り当てを追加」をクリック
3. 条件となるタグの組み合わせを選択
4. 各プラットフォームで付与するロールを設定：
   - **Discord**: サーバーロールを選択
   - **VRChat**: グループ内ロールを選択
   - **GitHub**: Teamメンバーシップを選択
5. 「作成」をクリック

### 設定例
```
条件: タグ「開発者」AND「管理者」
結果:
- Discord: @Lead Developer ロール
- VRChat: Admin ロール
- GitHub: maintainers Team追加
```

### 高度な条件設定
- 複数タグのAND/OR条件
- 除外条件の設定
- 優先度による競合解決

---

## 7. メンバー追加

### 概要
ネームスペースにメンバーを追加し、適切なタグを割り当てます。

### 手順
1. 「メンバー管理」に移動
2. メンバー追加方法を選択：
   - **手動追加**: ユーザー名/IDを直接入力
   - **検索機能**: プラットフォーム横断検索
   - **テーブル貼り付け**: テーブルデータを一括で貼り付け
3. 追加したメンバーにタグを割り当て
4. 「追加」または「更新」をクリック

### メンバー検索機能
- Discord: ユーザー名#番号、User ID
- VRChat: Display Name、User ID
- GitHub: ユーザー名、User ID

### 招待システム
- 専用の招待URLを生成
- 有効期限と使用回数の制限設定
- 招待されたユーザーの自動タグ割り当て

---

## 8. 差分の反映

### 概要
設定したマッピングルールに基づいて、実際のプラットフォームにロール変更を適用します。

### 手順
1. 「ロール管理」の「割り当て」に移動
2. 「差分を表示」をクリック
3. 表示された変更内容を確認：
   - 🟢 **追加**: 新規ロール付与
   - 🔴 **削除**: ロール削除
   - 🔵 **変更**: ロール変更
4. 適用したい変更を選択
5. 「適用」をクリック

### 差分の種類
- **ロール追加**: メンバーに新しいロールを付与
- **ロール削除**: 不要になったロールを削除
- **メンバー追加**: グループ/チームに新規メンバー追加
- **メンバー削除**: グループ/チームからメンバー削除

### 安全機能
- 変更前のプレビュー表示
- 部分的な適用が可能
- 実行ログの記録
- ロールバック機能

---

## 🔧 トラブルシューティング

### よくある問題

#### サービスアカウントの接続エラー
- 認証情報の確認
- サービス側の権限設定確認
- APIレート制限の確認

#### ロールが正しく付与されない
- マッピングルールの条件確認
- メンバーのタグ割り当て確認
- プラットフォーム側のロール存在確認

#### 差分が表示されない
- サービスグループの同期状態確認
- キャッシュのクリア
- サービスアカウントのアクセス権限確認

### サポート
問題が解決しない場合は、プロジェクトのIssueページまたは管理者にお問い合わせください。

---

## 📝 まとめ

Role Management Automationを使用することで：

1. **効率化**: 複数プラットフォームでのロール管理を自動化
2. **一貫性**: 統一されたルールでロール付与を実現
3. **可視化**: メンバーの状況を一元的に把握
4. **安全性**: 変更前の確認と段階的な適用

これらの機能により、チームやプロジェクトのロール管理を大幅に効率化できます。
